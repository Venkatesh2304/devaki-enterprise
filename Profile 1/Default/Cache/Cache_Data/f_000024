<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Credit Locking</title>
<script type="text/javascript">
var contextPath = '/rsunify';
</script>
<link rel="shortcut icon" href="/rsunify/resources/imgs/favico.png" />
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/themes/default/easyui.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/themes/icon.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/index.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/customStyle.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/productMaintainceCategory.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/Index.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/app-styles.css?v=R22.3.1_20220329081806">
<style type="text/css">
	#databse-info-div {
       position: fixed;
	   bottom: 0;
	   width: 100%;
	   background: #edeff1;
	   height: 20px;
	   text-align: center;
	   color: #000;
	   font-family: sans-serif;
	   font-weight: bold;
	   text-shadow: 0 1px 0 #84BAFF;
	   box-shadow: 0 0 13px #00214B;
	   text-transform: uppercase;
    }
    #databse-info-div div {
       	font-size: 13px !important;
       	font-family: sans-serif;
       	padding-right: 20px;
       	text-align: right;
      	    padding-top: 4px;
    }
    .chat-img{
    	float: right;
    	cursor: pointer !important;
    	margin-right: 2px;
    }
</style>
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/jquery.datepicker.css?v=R22.3.1_20220329081806">
<link href="/rsunify/resources/CSS/ui.tree-view.css?v=R22.3.1_20220329081806"
	rel="stylesheet" type="text/css" id="skinSheet">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/reportapi/theme1.css?v=R22.3.1_20220329081806">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/jquery-ui-1.10.4.custom.min.css?v=R22.3.1_20220329081806">
<script type="text/javascript"
	src="/rsunify/resources/js/jquery-1.10.2.js?v=R22.3.1_20220329081806"></script>
<script
	src="/rsunify/resources/js/jquery-ui-treeview.js?v=R22.3.1_20220329081806"
	type="text/javascript"></script>
<script type="text/javascript"
	src="/rsunify/resources/easyui/jquery.easyui.min.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/easyui/datagrid-cellediting.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/easyui/datagrid-filter.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/moment.min.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/custom-ui.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.datebox.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/keynavigator.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/vscontext.jquery.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/reportapi/appJsFile.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/date.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.datepicker.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/tableHeadFixer.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/tablenav.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.hotkeys.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.floatThead.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.blockUI.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/maintab.js?v=R22.3.1_20220329081806"></script>
<script type="text/javascript"
		src="/rsunify/resources/js/cookiesUtils.js?v=R22.3.1_20220329081806"></script>
		<script
	src="/rsunify/resources/transactions/js/utils/rsu-date-behaviour.js?v=R22.3.1_20220329081806"
	type="text/javascript"></script>
	<script type="text/javascript" src="/rsunify/resources/js/jquery-ui.min.js?v=R22.3.1_20220329081806"></script>
		
<script type="text/javascript" src="/rsunify/resources/js/inputmask.js?v=R22.3.1_20220329081806"></script>	 
<script type="text/javascript" src="/rsunify/resources/js/inputmask.date.extensions.js?v=R22.3.1_20220329081806"></script>	
<script type="text/javascript" src="/rsunify/resources/js/jquery.inputmask.js?v=R22.3.1_20220329081806"></script>
<link rel="stylesheet" type="text/css" href="/rsunify/resources/CSS/chatbot-css.css?v=R22.3.1_20220329081806">
<script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js?v=R22.3.1_20220329081806"></script> 
		
<script type="text/javascript">
var mocBakcupFlag = "";
var isForceClose = 0;
var import_flg_running = false;
var excludedScreensNames = ["Backup Database", "Beat Export", "Month Operating Cycle (MOC) - Closing and E-claim submission"];
//Check if window opened directly redirect to Error screen
if(window != undefined && window.name != undefined && $.trim(window.name) != ""){
	addScreeNameInLocalStorage(window.name);
} else {
	//showBrowserErrorMessage("User can't access the screen. Close it manually..");
	redirectUserToErrorPage("/rsunify/views/errorPages/ikeaError.jsp");
}
var localTimer;
var impInterval;
var window_doc_path = null;
$(document).ready(function(){
	$(document).on('focus', ':input', function() {
		if( window.name == "Party Request Propasal Submission" ){
			$(this).attr('autocomplete', 'new-password' + Math.random().toString().replace( ".", "" ) );
		} else {
			$(this).attr('autocomplete', 'off');
		}
	});

	$( document ).on( "click", ".help:visible", function(){
		var context = $( this ).attr( "data-context" )
		if( window_doc_path != null ){
			window_doc_path.close();
		}
		if( context != "" && context != undefined ){			
			window_doc_path = window.open( '/rsunify/views/doc/index.jsp?path_directory='+context, '_blank' );
		} else {
			window_doc_path = window.open( '/rsunify/views/doc/index.jsp', '_blank' );
		}
	});
	
	$( window ).on( "keydown keyup", function(e){
		if( e.keyCode == 112 ){
			e.preventDefault();
			$( ".help" ).click();
		}
	});
	
	
	$( ".dateMaskFilter" ).attr( "data-behaviour", "date" );
	$( ".dateMaskFilter" ).removeClass( "dateMaskFilter" );
	writeLogMessageToServer("common-js-css.jsp ready(): " + document.cookie);
	if(window != undefined && window.name != undefined && $.trim(window.name) != ""){
		updateScreenNameIntoSession(window.name, 0);
	}
	$('div.txt-sms-display').drags();
	var inputContextID = $("#contextID").val();
	if(inputContextID !== "1648848354629"){
		//alert("Context IDs are Not matching Please Close Tab");
	}
	//console.log("Application Context ID: " + inputContextID + " --- 1648848354629");
	//window close event handle
	$(window).on("unload", function(){
		//window.opener.updateScreenStatus(window.name, 0);
		writeLogMessageToServer("common-js-css: unload - " + document.cookie);
		if(window.opener != null && window.opener.updateScreenStatus && typeof(window.opener.updateScreenStatus) === "function") {
            window.opener.updateScreenStatus(window.name, 0);
	    } else {
			removeScreenNameFromSession(window.name, 0);
	    }
	});
	//if user click outside when confirmation box exists changes - Rajesh
	var lastConfFocusButton = "";
	$(document).on("click contextmenu", function(){
		if($(".messager-window").is(":visible")){
			if(lastConfFocusButton === "")
				lastConfFocusButton = $(".messager-window").find(".l-btn:first")
			lastConfFocusButton.focus();
		}
	});
	$(document).on("mousedown", function(){
		if($(".messager-window").is(":visible")){
			lastConfFocusButton = $(":focus");
		}
	});
	var randomNumber = Math.floor((Math.random() * 9) * 100);
	localTimer = setInterval(checkLocalStorage, (2000+randomNumber));
	$.ajaxSetup({
        global: true,
        beforeSend: function (jqXHR, settings) {
            if(import_flg_running && settings['url'].indexOf("checkImportProc") == -1){
            	showDiaplyAlertMessages("Import Data Process Running not allowed to do any transaction!..", "error");
            	jqXHR.abort();
            	return false;
            }
        }
    });
	impInterval = setTimeout(checkImportProcStatus, (60*1000));
	getRsInformationReportsFooter();
});
function checkImportProcStatus(){
	$.ajax({
  		method : "POST",
  		url : "/rsunify/app/ikeaCommonUtilController/checkImportProc",
  		cache: false,
  		success : function(jsonResponse) {
  			if(jsonResponse != undefined && jsonResponse['status'] != undefined){
  				import_flg_running = jsonResponse['status'];
  			}
  			clearTimeout(impInterval);
  			impInterval = setTimeout(checkImportProcStatus, (60*1000));
  		}, error : function(){
  			clearTimeout(impInterval);
  			impInterval = setTimeout(checkImportProcStatus, (60*1000));
  		}
  	});
}
$(document).ajaxError(function(event, jqxhr, settings, thrownError) {
	//console.log("Triggered ajaxError handler." + jqxhr.status);
	if(jqxhr.status === 750){
		isForceClose = 1;
		if(window.opener == undefined || window.opener == null || (window.opener == window)){
			redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
		} else {
			if(window.opener.redirectToLogin && typeof(window.opener.redirectToLogin) === "function") {
				window.opener.redirectToLogin();
				window.close();
			} else {
				redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
			}
		}
	}
	 //window.location.href = "./login.jsp";
});

function dateMaskFilter(){
	//Common Validation for all the date related inputs. 
             $(".dateMaskFilter").inputmask("dd/mm/yyyy",{
                     "onincomplete": function(){
                           var day, month, year, unfilledDay, unfilledMonth, unfilledYear, newDay = null,
                           newMonth = null, newYear = null, newDate, charYear;
                           
                           day = $(this).val().substring(0, 2);
                           month = $(this).val().substring(3, 5);
                           year = $(this).val().substring(6, 10);
                           
                           todayDate = new Date();
                           
                           //handle day
                           unfilledDay = (day.match(new RegExp("d", "g")) || []).length
                           if(unfilledDay === 0){
                                  newDay = day;
                           }else if(unfilledDay === 1 && day.charAt(0) == "d"){
                                  newDay = "0" + day.charAt(1);
                           }else if(unfilledDay === 1 && day.charAt(1) == "d"){
                                  newDay = "0" + day.charAt(0);
                           }
                          
                           //handle month
                           unfilledMonth = (month.match(new RegExp("m", "g")) || []).length
                           if(unfilledMonth === 0){
                                  newMonth = month;
                           }else if(unfilledMonth === 1 && month.charAt(0) == "m"){
                                  newMonth = "0" + month.charAt(1);
                           }else if(unfilledMonth === 1 && month.charAt(1) == "m"){
                                  newMonth = "0" + month.charAt(0);
                           }
                           
                           //handle year
                           unfilledYear = (year.match(new RegExp("y", "g")) || []).length
                           console.log(unfilledYear);
                           if(unfilledYear === 0){
                                  newYear = year;
                           }else if(unfilledYear === 1){
                        	    var first2Chars = year.substring(0, 2);
                                charYear = year.substring(2, 3);
                        	    if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                        	    	newYear = first2Chars + "0" + charYear;
                        	    }
                           }else if(unfilledYear === 2){
                                  charYear = year.substring(0, 2);
                                  if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                                         newYear = "20" + charYear;
                                  }
                           }else if(unfilledYear === 3){
                                  charYear = year.substring(0, 1);
                                  if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                                         newYear = "200" + charYear;
                                  }
                           }else if(unfilledYear === 4){
                                  newYear = todayDate.getFullYear();
                           }
                           
                        //After day, month and year calculations..
                        if( newDay == null || newMonth == null || newYear == null ){
                               $(this).focus();
                               $('#display-message').text('Please enter valid date').addClass('txt-black');
                        }else{ 
                               if(newDay === "00"){ newDay = todayDate.getDate();}
                               if(newMonth === "00"){ newMonth = todayDate.getMonth() + 1;}
                               newDate = newDay + "/" + newMonth + "/" + newYear;
                               $(this).val(newDate);
                        }                       
                     },
                     "oncomplete": function(){    
                    	 //do something on completing... 
                     }
              });
	
                   /*                 $(".date-pick").inputmask("dd/mm/yyyy",{ 
                        "onincomplete": function(){ 
								$(this).focus();
                                $('#display-message').text("Value is not valid date.").removeClass('txt-black').addClass('txt-red'); 
                        },
                        "oncomplete": function(){ 
                                $('#display-message').text("").removeClass('txt-red').addClass('txt-black');
                        }
	            }); */
}

$(document).ready(function(){
$(".dateMaskFilter").focusout(function(){
	var checkLeap = $(this).val().split('/');
	//console.log(checkLeap[2]);
	validateBeforeInputMask($(this));
	if((checkLeap[2] % 4 == 0) && (checkLeap[2] % 100 != 0) || (checkLeap[2] % 400 == 0)){
	  if(checkLeap[1] == 2 && checkLeap[0] > 29){
		  $(this).val('29/02/'+checkLeap[2])		  
	  }
    }else{
    	if(checkLeap[1] == 2 && checkLeap[0] > 28){
  		  $(this).val('28/02/'+checkLeap[2])		  
  	  }
    }

	
	if(checkLeap[1] == 4 && checkLeap[0] > 30){
		  $(this).val('30/04/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 6 && checkLeap[0] > 30){
		  $(this).val('30/06/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 9 && checkLeap[0] > 30){
		  $(this).val('30/09/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 11 && checkLeap[0] > 30){
		  $(this).val('30/11/'+checkLeap[2])		  
	  }
});

$(".dateMaskFilter").keydown(function(e){
	if(e.ctrlKey && e.keyCode==67){document.execCommand('copy');}
	else if(e.shiftKey && e.keyCode==9 && ($(this).val()=="")){}
	else if(e.keyCode==9 && ($(this).val()=="")){
		$(this).siblings('a').focus();
		 $(this).val('');
		 return false;
	}
		});
		
var clickflag = false;	
var downPos
$('#boticon').mousedown(function(e){
	clickflag = false;
	downPos = $(this).position();
});
$('#boticon').mouseup(function(e){
	
	var upPos = $(this).position();
	if( Math.abs( downPos.top - upPos.top ) < 2 && Math.abs( downPos.left - upPos.left ) < 2){
		clickflag = true;
	}
});
$('#boticon').draggable({
	containment: "window",
});
$('#boticon').click(function(event) {
   		if(clickflag){
   			myFunction();
   		}
});
});
function validateBeforeInputMask(dateObj){
    //console.log("onincomplete event..");
	var day, month, year, unfilledDay, unfilledMonth, unfilledYear, newDay = null,
    newMonth = null, newYear = null, newDate, charYear;
    
    day = dateObj.val().substring(0, 2);
    month = dateObj.val().substring(3, 5);
    year = dateObj.val().substring(6, 10);
    
    todayDate = new Date();
    
    //handle day
    unfilledDay = (day.match(new RegExp("d", "g")) || []).length
    if(unfilledDay === 0){
           newDay = day;
    }else if(unfilledDay === 1 && day.charAt(0) == "d"){
           newDay = "0" + day.charAt(1);
    }else if(unfilledDay === 1 && day.charAt(1) == "d"){
           newDay = "0" + day.charAt(0);
    }
   
    //handle month
    unfilledMonth = (month.match(new RegExp("m", "g")) || []).length
    if(unfilledMonth === 0){
           newMonth = month;
    }else if(unfilledMonth === 1 && month.charAt(0) == "m"){
           newMonth = "0" + month.charAt(1);
    }else if(unfilledMonth === 1 && month.charAt(1) == "m"){
           newMonth = "0" + month.charAt(0);
    }
    
    //handle year
    unfilledYear = (year.match(new RegExp("y", "g")) || []).length
    //console.log(unfilledYear);
    if(unfilledYear === 0){
           newYear = year;
    }else if(unfilledYear === 1){
 	    var first2Chars = year.substring(0, 2);
                            charYear = year.substring(2, 3);
 	    if((charYear.match(new RegExp("y", "g")) || []).length === 0){
 	    	newYear = first2Chars + "0" + charYear;
 	    }
    }else if(unfilledYear === 2){
           charYear = year.substring(0, 2);
           if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                  newYear = "20" + charYear;
           }
    }else if(unfilledYear === 3){
           charYear = year.substring(0, 1);
           if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                  newYear = "200" + charYear;
           }
    }else if(unfilledYear === 4){
           newYear = todayDate.getFullYear();
    }
    newDate = newDay + "/" + newMonth + "/" + newYear;
  	//After day, month and year calculations..
    if( newDay == null || newMonth == null || newYear == null ){
    	dateObj.focus();
        $('#display-message').text('Please enter valid date').addClass('txt-black');
    } else {
	    dateObj.val(newDate);
    }
}
function removeScreenNameFromSession(screenName, multiUserCheck){
	var jsonData = {};
        jsonData.screenName = screenName;
        $.ajax({
		     type: "POST",
		     url: "/rsunify/app/ikeaCommonUtilController/removeScreenNameFromSession",
		     data: {"strJsonParams":JSON.stringify(jsonData)},
	   	             dataType: "",
	   	             success: function (jsonResponse) {
	   		        //serverResp = jsonResponse;
		        console.log(jsonResponse);
		     },
		     error: function (jsonResponse) {
			  //do nothing
			 console.log(jsonResponse);
		     }
	    });
}

function updateScreenNameIntoSession(screenName, isTrackUpdate){
	var jsonData = {};
	jsonData.screenName = screenName;
	jsonData.pbayoutUpdate = ""+isTrackUpdate;
	jsonData.mainTabFlag = "0";
	$.ajax({
		type: "POST",
		url: "/rsunify/app/ikeaCommonUtilController/updateScreenNameIntoSession",
		data: {"strJsonParams":JSON.stringify(jsonData)},
    	dataType: "",
		async: false,
    	success: function (jsonResponse) {
    		//validateRepsonseAndContinue(jsonResponse, loadPageURL, screenName);
		},
		error: function (jsonResponse) {
			//do nothing
		}
   	});
}
function addScreeNameInLocalStorage(screenName){
	writeLogMessageToServer("common-js-css: addScreeNameInLocalStorage - " + document.cookie);
	var sessionArray = {};
	var  tabsOpened = readCookie("tabsOpened");
	if(tabsOpened == undefined || tabsOpened == "" || $.isEmptyObject(JSON.parse(tabsOpened))){
		//sessionArray = {"date":new Date(), "openedTabs":[]};
	} else {
		sessionArray = JSON.parse(tabsOpened);
		if($.inArray(screenName, sessionArray['openedTabs']) == -1){
			sessionArray['openedTabs'].push(screenName);
		}
		setCookie("tabsOpened", JSON.stringify(sessionArray));
	}
}
function checkLocalStorage(){
	writeLogMessageToServer("common-js-css: checkLocalStorage - " + document.cookie);
	var  tabsOpened = readCookie("tabsOpened");
	if(tabsOpened != undefined && tabsOpened != ""){
		var sessionArray = JSON.parse(tabsOpened);
		if($.inArray(window.name, sessionArray['openedTabs']) == -1){
			redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
		}
	} else 
		redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
}
function redirectUserToErrorPage(pageURL){
	/*If any moc, backup or qtm export is running don't invalidate*/
	writeLogMessageToServer("common-js-css: redirect- " + document.cookie);
	if(!validateBeforeCloseorRedirect()){
		addScreeNameInLocalStorage(window.name);
		return false;
	} else {
		clearInterval(localTimer);
		window.name = "";
		window.onunload = "";
		window.onbeforeunload = "";
		$(window).off("beforeunload");
		$(window).off("unload");
		var windowURL = window.location.href;
		//exlcude active screens info
		if(windowURL.indexOf("views/utilities/ikeaActiveScreen.jsp") == -1){
			try{window.close();}catch (e){}
			if(window.closed == false){
				window.location.href = pageURL;
			}
		}
	}
}
/*If any moc, backup or qtm export is running don't invalidate*/
function validateBeforeCloseorRedirect(){
	var result = true;
	if(isForceClose == 0){
		if($.inArray(window.name, excludedScreensNames) != -1){
			if(!checkBackupOrMocRunning()){
				result = false;
			}
		}
	}
	return result;
}
function checkBackupOrMocRunning(){
	var isContinue = true;
	$.ajax({
  		method : "POST",
  		url : "/rsunify/app/ikeaCommonUtilController/validateMocOrBackupRunning",
  		async: false,
  		cache: false,
  		data: "",
  		success : function(jsonResponse) {
  			mocBakcupFlag = jsonResponse; 
  			if(jsonResponse == undefined || $.trim(jsonResponse) == "" || jsonResponse == "NOT_RUNNING"){
  				isContinue = true;
  			} else {
  				//setCookie("maitabOpened", "Yes");
				//setCookie("tabsOpened", JSON.stringify({"date":new Date(),"openedTabs":["Login",jsonResponse]}));
  				isContinue = false;
  			}
  			if(isContinue)
  			{
  				var mocProcessStatus = readCookie("mocProcesStatus");
  				var lastUpdatedTime = -1;
  				//check last update time
  				if(mocProcessStatus === "Completed"){
  					lastUpdatedTime = Number(readCookie("processLastUpdatedTime"));
  					lastUpdatedTime = isNaN(lastUpdatedTime) ? 0 : lastUpdatedTime;
  					lastUpdatedTime = formatCurrentDateToMillis() - lastUpdatedTime;
  					lastUpdatedTime = isNaN(lastUpdatedTime) ? 0 : lastUpdatedTime;
  				}
  				if(mocProcessStatus === "InProgress" || (lastUpdatedTime > 0 && lastUpdatedTime <= (5*60*1000))){
  					isContinue = false;
  				}
  			}
  		}, error : function(){
  			isContinue = true;
  		}
  	});
	return isContinue;
}
function vsContextMenuKeyEvent( keyName ) {
	var returns = false;
		$( ".vs-context-menu ul li" ).each( function() {
			var liTag = this;
			if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
				var aEnable = $( liTag ).find( "a" );
				if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
					if( $( aEnable ).text().toUpperCase().indexOf( keyName.toUpperCase() ) != -1 ) {
						$( aEnable ).trigger( "click" );
						returns = true;
						return false;
					}
				}
			}
		});
	return returns;
}

function findActiveVsContextMenu( container, currentLiIdx, mode ) {
		var i=currentLiIdx,totalCount = $( container ).find( "ul li" ).length;
		if( mode == "NEXT" ) {
			i++;
			for( ; i < totalCount; i++ ) {
				var liTag = $( container ).find( "ul li:eq("+i+")" );
				if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
					var aEnable = $( liTag ).find( "a" );
					if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
						return aEnable;
					}
				}
			}
		} else {
			i--;
			for( ; i >= 0; i-- ) {
				var liTag = $( container ).find( "ul li:eq("+i+")" );
				if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
					var aEnable = $( liTag ).find( "a" );
					if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
						return aEnable;
					}
				}
			}
		}
		return "";
} 

function setFirstActiveVsContextMenu( container ) {
	$( container ).find( "ul li" ).each( function() {
		if( !( $( this ).attr( "disabled" ) === "disabled" ||  $( this ).attr( "disabled" ) == "true" ) )
			var aEnable = $( this ).find( "a" );
			if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
				aEnable.addClass( "vs-context-menu-a-active" );
				return false;
			}
	} );
	
}

function setLastActiveVsContextMenu( container ) {
	$( $( container ).find( "ul li" ).get().reverse() ).each( function() {
		if( !( $( this ).attr( "disabled" ) === "disabled" ||  $( this ).attr( "disabled" ) == "true" ) )
			var aEnable = $( this ).find( "a" );
			if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
				aEnable.addClass( "vs-context-menu-a-active" );
				return false;
			}
	} );
}

/* Code to prevent the right click */
$(document).on('contextmenu',function(e){
	 if(e.which=='3'){
		  e.preventDefault();
		} 
});
$(document).on('contextmenu', '.messager-window, #dp-popup', function(e){
	if(e.which=='3'){
	  e.preventDefault();
	}
});

var vscontext = {
		preFocus: ""	
	};

	$( document ).on( "vscontext-show", ".vs-context-menu",  function( e ){
		var that = this;
		$( this ).attr( "tabindex", -1 );
		setTimeout( function() {
			vscontext.preFocus = $( ":focus" );
			$( that ).focus();
			
			if( !$( that ).is( ":focus" ) ) {
				$( that ).hide();
				return false;
			}
			
			$( that )[0].onkeydown = function( e ) {
				 var theEvent = e || window.event;
			 	 var key = theEvent.keyCode || theEvent.which;
			 	 if( key == 13 ) {
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		if( activeA.length > 0 ) {	
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
			 		 	setTimeout( function() {
			 				activeA.trigger( "click" );
			 		 	}, 100 );
			 		}
			 		return false;
			 	 } else if( key == 27) {
			 		$( that ).hide();
			 		$( that ).trigger( "vscontext-hide-focus" );
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 40 ) {
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		 if( activeA.length > 0 ) {
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			 var parentLi = activeA.parent( "li" );
			 			 var nextA = findActiveVsContextMenu( that, parentLi.index(), "NEXT" );
			 			 if( nextA.length > 0) {
			 				nextA.addClass( "vs-context-menu-a-active" );
			 			 } else {
			 				setFirstActiveVsContextMenu( that );
			 			 }
			 		 } else {
			 			setFirstActiveVsContextMenu( that ); 
			 		 }
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 38 ) {
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		 if( activeA.length > 0 ) {
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			 var parentLi = activeA.parent( "li" );
			 			 var prevA = findActiveVsContextMenu( that, parentLi.index(), "PREV" );
			 			 if( prevA.length > 0) {
			 				prevA.addClass( "vs-context-menu-a-active" );
			 			 } else {
			 				setLastActiveVsContextMenu( that );
			 			 }
			 		 } else {
			 				setLastActiveVsContextMenu( that );
			 		 }
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 78 ) { 
			 		if( vsContextMenuKeyEvent( "NEW" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
			 			theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 79 ) { 
			 		if(	vsContextMenuKeyEvent( "OK" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 67 ) { 
			 		if(	vsContextMenuKeyEvent( "CLEAR" ) || vsContextMenuKeyEvent( "CLOSE" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 70 ) { 
			 		if(	vsContextMenuKeyEvent( "FIND" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 71 ) { 
			 		if(	vsContextMenuKeyEvent( "GENERATE" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 83 ) { 
				 		if(	vsContextMenuKeyEvent( "SAVE" ) ) {
				 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
				 			$( that ).hide();
					 		theEvent.preventDefault();
					 		theEvent.stopPropagation();
					 		return false;
				 		}
				} else if( key == 69 ) {
			 		if(	vsContextMenuKeyEvent( "PREVIEW" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
				 	 }
			};
		}, 10 );
	} );

	$( document ).on( "mouseenter", ".vs-context-menu ul li a", function(e) {
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( this ).addClass( "vs-context-menu-a-active" );
	} );


	$( document ).on( "vscontext-hide", ".vs-context-menu",  function( e ){
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( ".vs-context-menu" ).removeAttr( "tabindex" );
		$( ".vs-context-menu" )[0].onkeydown = null;
	} );

	$( document ).on( "vscontext-hide-focus", ".vs-context-menu",  function( e ){
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( ".vs-context-menu" ).removeAttr( "tabindex" );
		$( ".vs-context-menu" )[0].onkeydown = null;
		if( vscontext.preFocus.length > 0 ) {
				vscontext.preFocus.focus();
			}
	} );
	
	function writeLogMessageToServer(logMessage){
		if(window.opener != null && window.opener.writeConsoleToServerLog && typeof(window.opener.writeConsoleToServerLog) === "function") {
			window.opener.writeConsoleToServerLog(logMessage);
		}
	}
	
	function printReport(filePath, printerName,destroyCallback, yesCallback, noCallback){
		printReportFile("/rsunify",filePath, printerName, yesCallback, noCallback, destroyCallback);
	}
	
	function prepareAvailablePrinters(){
		return preparePrinterSelection("/rsunify");
	}
	
	function printPreview(filePath){
		previewReportNewTab("/rsunify", filePath);
	}
	
	function previewExcelSheet(filePath){
		previewExcelReportNewTab("/rsunify", filePath);
	}
	
	function getRsInformationReportsFooter(){
	     var jsonObj = {"viewName" : "RS_INFORMATION"};
		 $.ajax({
		      method : "POST",
		      url : "/rsunify/app/reportsController/getReportScreenData.do?jasonParam="+JSON.stringify(jsonObj),
		      async: true,
		      success : function(data) {
		          $.each( data,function(key, card) {
		               if(card != undefined && card.length >= 2){
		                    //rsInfo.rsCode=(card[i][1]);
		                    //console.log("Agency Name is: " + card[1][2]);
		                    $("#distributor_name").text(card[1][1] + " - " + card[1][2] + " ("+card[1][9]+")");
		                    //rsInfo.rsAgencies=(card[0][2]);
		                    //rsInfo.dimAddress1=(card[i][3]);
		                    //rsInfo.dimAddress2=(card[i][4]);
		                    //rsInfo.dimAddress3=(card[i][5]);
		                    //rsInfo.dimState=(card[i][6]);
				            //rsInfo.tinNumber=(card[i][7]);
				            //rsInfo.pinCode=(card[i][8]);
		               }
		          });
		      }
		 });
	}
	/*chat bot script starts here*/
	
	if("true" == "true"){
		var chatClose = false;
		function myFunction() {	
			$("#rsu-logtodo-menu-item").trigger("click");
			 document.getElementById("botsection").style.display = "block";
			  document.getElementById('boticon').style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "block";
			  document.getElementById("callIconAfter").style.display = "none";
			  document.getElementById("homeIconCall").style.display = "none";
			  document.getElementById("homeIcon").style.display = "block";
			  //console.log('inside myFunction '+close);
			 
			  		  
			  if(chatClose){
				 //console.log('inside myFunctionif '+close);
				  //document.getElementById('botsection').append('div');
				  
		          $(".bot-delete").remove();
		          document.getElementById('botsection').innerHTML += '<div id="bot" class="bot-delete" style="display: none;"></div>';
				  
				  window.WebChat.renderWebChat(
		            {
		               directLine: window.WebChat.createDirectLine({
		                  token: 'hm97epYqYoc.yfedIx4nGVcT4aw-bmfmWWnk52vZjxtTlCNrxM9y2zw'
		               }),
					   
		            },
		            document.getElementById('bot')
		          );
				  chatClose = false;
				}
			 }
			 
			function minimizeChat() {
			  document.getElementById("botsection").style.display = "none";
			  document.getElementById('boticon').style.display = "block";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			}
			
			function helplineWIndow() {
			  document.getElementById("overlayHelpline").style.display = "block";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "none";
			  document.getElementById("callIconAfter").style.display = "block";
			  document.getElementById("homeIcon").style.display = "none";
		   	  document.getElementById("homeIconCall").style.display = "block";
			}
			
			function closeChat() {
				document.getElementById("overlay").style.display = "block";
				document.getElementById("overlayHelpline").style.display = "none";
			}
			
			function refreshChat() {
			  document.getElementById("botsection").style.display = "block";
			  document.getElementById('boticon').style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "block";
			  document.getElementById("callIconAfter").style.display = "none";
			  document.getElementById("homeIconCall").style.display = "none";
			  document.getElementById("homeIcon").style.display = "block";
			  document.getElementById('botsection').innerHTML += '<div id="bot" class="bot-delete" style="display: none;"></div>';
			}
			
			function yes(){
				document.getElementById("botsection").style.display = "none";
			  	document.getElementById('boticon').style.display = "block";
			  	document.getElementById("overlay").style.display = "none";
			   //location.reload();
			   chatClose = true;
			}

			function no(){
				document.getElementById("overlay").style.display = "none";
				chatClose = false;
			}
			
		(async function() {
				window.WebChat.renderWebChat(
				{
	               directLine: window.WebChat.createDirectLine({
	                  token: 'hm97epYqYoc.yfedIx4nGVcT4aw-bmfmWWnk52vZjxtTlCNrxM9y2zw'
	               }),
	            },
	            document.getElementById('bot')
			);
			}
		)().catch(err => console.error(err));
	}
	/*chat bot script end here*/
</script>
<div class="txt-sms-display">
 	<div class="txt-cont-are" id="display-message"></div>
</div>
<div class="ikea_alert_message_box">
	<div class="ikea_limen_alert_title">CU Sync Alert</div>
	<div class="ikea_limen_alert_content">
		<p id="ikea_limen_alert_content">
			LeverEDGE Limen Alert
		</p>
	</div>
</div>
<input type="hidden" id="contextID" value="1648848354629" />
<div id="databse-info-div">
	<div id="distributor_name">&nbsp;</div>
</div>
<!-- chat bot html starts here -->
<div id="boticon" style="animation-name: none !important;"></div>
	<div id="overlay">
		<div id="confirm_1" align="center">
			<p id="question">Do you want to end this session?</p>
			<div align="center"><button id="yes_1" onclick="yes()">Confirm</button><button id="no_1" onclick="no()">Cancel</button></div>
		</div>
	</div>
	<div id="botsection">
		<div id="bothead">
		<div style="margin-left: 18px;padding-top: 10px;">
			<div style="float:left;font-family: Helvetica;font-size: 15px;color: rgb(11,77,129);font-weight: bold;width: 20%;">
				Hello!
			</div>
			<div style="float:right;width: 80%;">
				<!-- <span id="closeIcon" onclick="closeChat()"><b style="font-size: 17px;"> X </b></span>
				<span id="minimizeIcon" onclick="minimizeChat()"><b style="font-size: 17px; margin-top: -9px;"> _ </b></span>
				<img src= "https://bnlwestgunileveraf01045.blob.core.windows.net/ikea-ui-dev/call_icon.png" id="callIcon" onclick="helplineWIndow()">
				<img src= "https://bnlwestgunileveraf01045.blob.core.windows.net/ikea-ui-dev/call_icon.png" id="callIconAfter" onclick="myFunction()"> -->
				<img src= "/rsunify/resources/imgs/icons8-multiply-16.png" id="c-close" class="chat-img" onclick="closeChat()"/>
				<img src= "/rsunify/resources/imgs/icons8-subtract-16.png" id="c-mimimze" class="chat-img" onclick="minimizeChat()"/>
				<img src= "/rsunify/resources/imgs/icons8-phone-message-16-1.png" id="callIcon" onclick="helplineWIndow()" class="chat-img"/>
				<img src= "/rsunify/resources/imgs/icons8-phone-message-16-1.png" id="callIconAfter" onclick="myFunction()" class="chat-img"/>
				<img src= "https://bnlwestgunileveraf01045.blob.core.windows.net/ikea-ui-dev/home1-nobg.png" id="homeIcon" class="chat-img" onclick="refreshChat()">
				<img src= "https://bnlwestgunileveraf01045.blob.core.windows.net/ikea-ui-dev/home1-nobg.png" id="homeIconCall" class="chat-img" onclick="refreshChat()">
			</div>
		</div>
		<div style="clear:both;"></div>
		<div>
		<span id="botmsg" lang="en" style="white-space: nowrap;"><!-- <b>Hello!</b> <br>-->Facing any issues with LeverEDGE?<br>I am here to help!</span>
		</div>
		<div id="overlayHelpline">
			<div id="eachContact">
					<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to LeverEDGE, iSquare/HHT, CRS/Order Page, Sub Stockist, and SalesEDGE</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> 1800 572 2485<br><b>Working hours:</b> 9:00 AM-9:00 PM (Mon-Sat)<br><br><b>Choose from options 1 to 6 after selecting prefered language:</b><br>For Assistance in LeverEDGE please press <b>1</b>.<br>For Assistance in iSquare and HHT please press <b>2</b>.<br>For Assistance in CRS and Order Page please press <b>3</b>.<br>For Registering any feedback or complaints in Lever care please press <b>4</b>.<br>For Assistance in Sub Stockist please press <b>5</b>.<br>For Assistance in SalesEdge please press <b>6</b>.<br>To go back to Main Menu please press <b>0</b>.</span><br></div>
				</div>
			<div id="eachContact">
					<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to iCube</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> +918047103231<br><b>Working hours:</b> 9:00 AM-5:00 PM<br><b>Email ID:</b> iCube.Helpdesk@unilever.com</span><br></div>
				</div>
			<div id="eachContact">
					<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to Shikhar</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> 1800 123 2105<br><b>Working hours:</b> 9:00 AM-5:00 PM</span><br></div>
				</div>
			<!-- <div id="eachContact">
			<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to LeverEDGE, iSquare/HHT, CRS/Order Page, Sub Stockist, and SalesEDGE</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> 1800 572 2485<br><b>Working hours:</b> 9:00 AM-9:00 PM (Mon-Sat)<br><br><b>Choose from options 1 to 6 after selecting prefered language:</b><br>For Assistance in LeverEDGE please press <b>1</b>.<br>For Assistance in iSquare and HHT please press <b>2</b>.<br>For Assistance in CRS and Order Page please press <b>3</b>.<br>For Registering any feedback or complaints in Lever care please press <b>4</b>.<br>For Assistance in Sub Stockist please press <b>5</b>.<br>For Assistance in SalesEdge please press <b>6</b>.<br>To go back to Main Menu please press <b>0</b>.</span><br>
			</div>
			</div>
			
			<div id="eachContact">
			<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to iCube</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> +918047103231<br><b>Working hours:</b> 9:00 AM-5:00 PM<br><b>Email ID:</b> iCube.Helpdesk@unilever.com</span><br>
			</div>
			</div>
			
			<div id="eachContact">
			<div style="display: inline-block;margin-left: 32px;margin-right: 5px;"><b style="font-size:15px;color:rgb(11,77,129);">For queries related to Shikhar</b><br><br><span style="font-size:15px;"><b>Helpdesk Number:</b> 1800 123 2105<br><b>Working hours:</b> 9:00 AM-5:00 PM</span><br>
			</div>
			</div> -->
			
			<div id="eachContact">
			<div style="display: inline-block;margin-left: 32px;margin-right: 5px;height: 62px;">
			</div>
			</div>
			<button id="backtoChat" onclick="myFunction()">Back to Chat</button>
	    </div>
		<div></div>
		
	</div>
	<iframe width="76%" height="400px" src="https://ikeasupportbotprod.azurewebsites.net/botui/index?data=41A392|VEN"></iframe>
	</div>
<!-- chat bot html ends here --><script type="text/javascript" src="/rsunify/resources/js/vscontext.jquery.js"></script>	
<script type="text/javascript" src="/rsunify/resources/js/common-ui.js?v=R22.3.1_20220329081806"></script>
<link rel="stylesheet" type="text/css" href="/rsunify/resources/CSS/app-styles1.css" />
		<script type="text/javascript" src="/rsunify/resources/js/custom-ui.js"></script>



<style>	
.textDiv
{
	margin-left: 100px;
    font-weight: bold;
}
.textDiv2
{
	       font-weight: bold;
    color: darkblue;
    width: 70px;
    display: inline-block;
}
.empty-div
{
	  height: 200px;
    margin: 3px;
    border: 1px solid black;
    overflow-y:scroll;
 
}
.checkboxStyle
{
	display: inline-block;
    margin-left: 40px;
    color: red;
    font-weight: bold;
}
.smlbox
{
	    float: right;
    width: 12px;
    height: 12px;
    margin-bottom: 2px;
    border: 1px solid cyan;
    position: relative;
    right : 4%;
 
}
.smlboxinside {
    position: absolute;
    width: 8px;
    background: black;
    height: 8px;
    top: 20%;
    right:25%;
}
#nameLabel
{
   color:black;
   text-align:left;
   font-weight:bold;
}
.formstock label
{
  color:darkblue;
  width:95%;
  display:inline-block;
  margin-top:-4px;
}
.textCheckbox
{
    display: inline-block;
    top: 37px;
    left: 348px;
    position: absolute;
}
.activeDiv
{
  background-color:#5B8BEB;
  border:1px dashed black;
}
 
@-moz-document url-prefix() {
  .moz-hght
  {
    height:280px !important;
  }
}
.footer-Style
{
  height:20px;
}
.report-list-active {
	background-color: #5B8BEB;
}

.pnl-footer {
	background: #999;
    padding: 7px 7px;
    overflow: hidden;
}

.form-content-area {
	background:#ccc;
	padding:5px 0px;
	overflow:hidden;
	border-bottom:1px solid #999;
	height: 80px;
}


</style>



 <style>
 .align {
	float:left;
	padding: 5px 10px; 
 }
 .popup-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	z-index: 999;
	background:#aaa;
	opacity:.3;
	filter:Alpha(Opacity=30);
}
 .dotDivchild
{
	position: absolute;
    width: 16px;
    height: 16px;
    padding-left: 3px;
    font-weight: bold;
    color:black;
}
.dotDivparent
{
    display: inline-block;
    height: 16px;
    width: 17px;
    border: 1px solid gray;
    position: absolute;
    left: 485px;
    top: 3px;
    background: #ccc;
}
.pops-all{
	    margin: 0 !important;
    position: fixed !important;
    width: 407px !important;
    height: 250px !important;
    border: 1px solid gray !important;
    z-index: 9999 !important;
    display: none;
}
 </style>
 <!-- <script type="text/javascript" src="/rsunify/resources/js/outletBeatPlgScreen.js?v=R22.3.1_20220329081806"></script>
 <script type="text/javascript" src="/rsunify/resources/js/outletBeatPlgScreen.js?v=R22.3.1_20220329081806"></script>-->
</head>

<body>	
<div class="app-layout-wrapper pop-wrapper" id="loadRssmBeatPlgLink">
	<div class="pnl-wrapper pnl-border pnl-wid-4" id="salesman-rssm-beat-link" style="top:70%;height:100px;,width: 105px !important;">
		<div class="pnl-header">
			<h4>Credit Locking</h4>
			<div class="pnl-header-btns-hldr">
				<a class="close close-sales-beat-plg" id="close" title="Close" onclick="BeatSequence_closeAndClear()"></a> 
				<!-- <a class="minim min-sales-beat-plg" title="Minimize"></a>  -->
				<a class="help" data-context="rssm_beat_linkage" title="Help"></a>
			</div>
		</div>
		<div class="pnl-content">
			<div class="form-content-area">
				<div class="col-1 formstock">
					<label style="width:80%;">
					<span style="float: left;width: 25%;text-align: right;">Beat</span><input type='text' id="old-beats" class="disablekey errorMsg" value='List of Beats' style='width:64.5%'></label>
   							<div class='dotDivparent' id='old-beats-box' style=' top: 0;    height: 16px !important;'><div id="select1"  class="dotDivchild">...</div></div>
   							<div class='popup-overlay' style="z-index: 999px !important; display: none;" id="outlet-popup-overlay"></div>
   							<div class="pnl-wrapper pnl-border pnl-wid-2 pops-all" id="beat-filter-search-popup">
						<div class="pnl-header">
							<h4>List of Beats</h4>
							<div class="pnl-header-btns-hldr">
								<a class="close cancel-filter-popup" title="Close"></a> 
							</div>
						</div>
						<div class="pnl-content">
							<div style="margin: 5px;">Search By&nbsp;&nbsp;<input type="text" class="report-list-search" style="margin-left:10px;width:200px;display:inline-block;float:none !important"><div class="checkboxStyle" style="display: inline-block;"><input type="checkbox" class="textCheckbox">All</div></div>
							<div class="empty-div ovrf-auto" style="height: 186px;border: 1px solid black;" id="beat-filter-div">
				               		
				         	</div>
						</div>
						<div style="clear:both;"></div>          
						<!--<div class="pnl-footer">
							 <input type="button" value="Ok" class="ok-filter-popup" id="beat-ok-filter-popup"/>
							<input type="button" value="Cancel" class="cancel-filter-popup" id="beat-cancel-filter-popup"/> 
						</div>-->
					</div>	
				</div>
				 <div class="col-1 formstock">	
		                   <input type="file" id="attach_file"  class="focus-msg errorMsg" focusMessage="Attach a file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="padding:5px 35px;font-weight:bold;margin-left:20px" onchange="checkfile(this)" >
		          </div>
		          <input type="button" value="Errors in Excel FIle" id='ErrorExcelSheet' onclick="ModifyExcelSheet()" class="focus-msg  align" style="width: 123px;display: block;margin-left: 18px;margin-top: -2px;background-color: indianred;" focusMessage="Errors in Excel File">
			</div>	
			<div style="clear:both;"></div>          
				<div class="pnl-footer">     
			      <input type="button" value="Upload" id='upload' onclick="uploadMethod()" class="outlet-reset" style="padding:5px 35px;font-weight:bold;margin-left:10px" focusMessage="upload a file">
				  <input type="button" value="Download" id="view_report" onclick="GenerateMethod()"  class="outlet-reset" style="padding:5px 35px;font-weight:bold;" focusMessage="Press Ctrl+G to ViewReprot">
			     <input type="button" value="Close" onclick="BeatSequence_closeAndClear()" id="close"  class="outlet-reset" style="padding:5px 35px;font-weight:bold;" focusMessage="Press Ctrl+O to Close">
			 
				</div>
			</div>	
		</div>
	</div>
</div>

<script>
$(function() {
	  $('#attach_file').focus();
	  showDiaplyAlertMessages("Attach a file", "info");
	  $('#ErrorExcelSheet').hide();
});

/********************************************************************/ 
 var vehicleWhereCondition = function(){
	  var obj = {};  
	  return obj;
 } 
 
 var preUrl = "/rsunify/app/reportsController";
 var rParamArray=[{idName:'old-beats-box', targetDiv: 'beat-filter-search-popup', hideDiv: 'creditLimitUpload', defMsg: 'List of Beats', isProcedure: false, viewName: 'OUTLET_OLD_BEAT_FILTERS_CREDITLIMIT', whereCond: vehicleWhereCondition,search: true,  oParamName: 'selBeats', oParam: 'id', idIndex: 1, textIndex:2 }
                 ];
 var outputObj = {};

 $(function(){
 commonUI_rList();
 });
  
  /*********************************************************************/
	
function checkfile(sender) {
    var validExts = new Array(".xlsx", ".xls",".XLSX",".XLS");
    var fileExt = sender.value;
    fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
    $('#ErrorExcelSheet').hide();
    if (validExts.indexOf(fileExt) < 0) {
    //var msg=showDiaplyAlertMessages("Invalid file selected, valid files are of " + validExts.toString() + " types", "error");
    dlg = $.messager.confirm({
		title : 'Warning',
		width : 400,
		msg : "Invalid File Selected, Please Select xls or xlsx File.",
		buttons : [ {
			text : 'Ok',
			onClick : function() {
				dlg.dialog('destroy');
			}
		}]
	})
    return false;
    }
    else return true;
}	
//Arrow Navigation
$(document).on('keyup','.focus-msg',function (e) {
   if (e.which ===40) {debugger;
      var index = $('.focus-msg:visible').index(this) + 1;
      $('.focus-msg:visible').eq(index).focus();
      var input_len=$('.focus-msg:visible').length;
      if(index==input_len){
     $('.focus-msg:visible').eq(0).focus();
      }
  }else if(e.which === 38){
    var index1 = $('.focus-msg:visible').index(this) - 1; 
    $('.focus-msg:visible').eq(index1).focus();
  }
 });
 
$(".cancel-filter-popup,#beat-ok-filter-popup").on("click", function(){
	//$("#filter-search-popup").hide();
	var escEvent = $.Event('keydown');
    escEvent.which = 27;
    $(this).parent('div').parentsUntil('div.form-content-area').trigger(escEvent);
});
 
$("input").not($(":button")).keypress(function (evt) {
	
    if (evt.keyCode == 13) {
        iname = $(this).val();
        if (iname !== 'Submit') {
            var fields = $(this).parents('form:eq(0),body').find(' input:visible, button:visible ');
            var index = fields.index(this);
            if (index > -1 && (index + 1) < fields.length) {
            	fields.eq(index + 1).focus();
            }
            return false;
        }
    }
}); 
 
 $(document).ready(function(){	 
	 $('.right-click-context-menu').vscontext({menuBlock: 'vs-context-menu'});
 });	
 $("#attach_file").on("focus",function(e) {
	 message="Attach a File";
	 showDiaplyAlertMessages(message,"info");
	 return false;
});
$("#upload").on("focus",function(e) {
	 message="Upload a File";
	 showDiaplyAlertMessages(message,"info");
	 return false;
});
$("#view_report").on("focus",function(e) {
	 message="Press Ctrl+G To ViewReport";
	 showDiaplyAlertMessages(message,"info");
	 return false;
});

$("#close").on("focusin",function(e) {
	 message="Press Ctrl+O To Close";
	 showDiaplyAlertMessages(message,"info");
	 return false;
}); 
  function BeatSequence_closeAndClear(){ 
	  	closeScreensOnClick=1;
		window.opener.updateScreenStatus('Credit Locking',1);
		window.close()
	}
  $(document).off("keydown").on("keydown", function(event){
	  if($('.dp-popup').is(':visible') && (event.keyCode == 27)){
	        return false;
	    }else if(event.keyCode == 27){
			 event.preventDefault();
			 BeatSequence_closeAndClear();
			event.stopPropagation();
		}
	});
  
	function showDiaplyAlertMessages(message, msgType){
		$("#display-message").text(message);
		if(msgType === "info"){
			$('#display-message').addClass("txt-black");
		} else {
			$('#display-message').removeClass("txt-black");
		}
	}
  
  
  $("#beatSequence input.focus-msg").focusin(function() {
		 
		var messages = $(this).attr("focusMessage");
		//alert(message);
		if (messages != undefined && $(this).hasClass("focus-msg")) {
			showDiaplyAlertMessages(messages, "info");
		}		
	});
  
  function ModifyExcelSheet(){
	  	data="CreditLimitSettingUpload.xlsx";
		downloadReportFile("/rsunify", data);
  }
function uploadMethod(){debugger
	
	//var attachFile=$('#attach_file').val().files[0].name;
     var attachFile= $('#attach_file').val();
     // console.log("form data " + formData);
	if(attachFile==""){
		showDiaplyAlertMessages("Please Attach a File", "error");
		return false;
	}else{
		//var attachFileSplit=attachFile.replace("C:\fakepath\","");
	//var attachFile=attachFile.replace("\\","\\\\");
	/* var data = {
            'attachFile' : attachFile
           }; */
    displayLoadingImage();
    var formData = new FormData();
	   formData.append('file', $('input[type=file]')[0].files[0]);
	$.ajax({
	method: "POST",
	url : '/rsunify/app/beatSequenceMaster/uploadFileCLSU',
	data : formData,
	processData: false,
	contentType: false,
	success : function(data) {
		//alert(data)
		hideLoadingImage();
		if ( data == "No Record" ) {
			$('#ErrorExcelSheet').hide();
			dlg = $.messager.confirm({
				title : 'Warning',
				width : 400,
				msg : 'Excel sheet containes Errors,Please uplaod valid Excel sheet',
				buttons : [ {
					text : 'Ok',
					onClick : function() {
						showDiaplyAlertMessages("Excel sheet containes Errors,Please uplaod valid Excel sheet", "error");
						dlg.dialog('destroy');
					}
				}]
			})
		} else if(data=="HeaderEmpty"){
		  dlg = $.messager.confirm({
				title : 'Warning',
				width : 400,
				msg : 'Excel Sheet Headers Should Not Be Empty.',
				buttons : [ {
					text : 'Ok',
					onClick : function() {
						$('#ErrorExcelSheet').hide();
						dlg.dialog('destroy');
					}
				}]
			})
	  }else if(data=="InvalidExcelSheet"){
		  dlg = $.messager.confirm({
				title : 'Warning',
				width : 400,
				msg : 'Excel Sheet Containes Errors , Please Upload Valid Excel Sheet.',
				buttons : [ {
					text : 'Ok',
					onClick : function() {
						$('#ErrorExcelSheet').show();
						dlg.dialog('destroy');
					}
				}]
			})
			
	  }else if(data=="WrongExcelFile"){
		  dlg = $.messager.confirm({
				title : 'Warning',
				width : 400,
				msg : 'Wrong Excel File Selected, Please Upload Valid Excel File.',
				buttons : [ {
					text : 'Ok',
					onClick : function() {
						showDiaplyAlertMessages("Wrong Excel File Selected", "error");
						dlg.dialog('destroy');
					}
				}]
			})
			
	  }else if(data=="ColumnHeaderFormatWrong"){
			$('#ErrorExcelSheet').hide();	
			dlg = $.messager.confirm({
				title : 'Warning',
				width : 300,
				msg : 'Column Names Headers Are Not Valid.',
				buttons : [ {
					text : 'Ok',
					onClick : function() {
						showDiaplyAlertMessages("Column Names Headers Are Not Valid.", "error");
						dlg.dialog('destroy');
					}
				}]
			})
		}else if(data=="errorWhileUploading"){
			function explode(){
				$('#ErrorExcelSheet').hide();	
				showDiaplyAlertMessages("Error While Uploading The File", "error");
				}
				setTimeout(explode, 1000);
		}else if(data=="success"){
			function explode(){
			$('#ErrorExcelSheet').hide();	
			$('#attach_file').val("");
			showDiaplyAlertMessages("File Uploaded Successfully", "info");
			}
			setTimeout(explode, 1000);
	  }
	else{	
		$('#ErrorExcelSheet').hide();
		function explode(){
		$('#ErrorExcelSheet').hide();	
		showDiaplyAlertMessages("Error Occured while Uploading The File", "error");
		}
		setTimeout(explode, 1000);
		}
	}, error: function(e) {
		$('#ErrorExcelSheet').hide();
		hideLoadingImage();
		function explode(){
		$('#ErrorExcelSheet').hide();	
		showDiaplyAlertMessages("Error Occured while Uploading The File", "error");		
		}
		setTimeout(explode, 1000);			
	}
		});
	  }
	}

//CTRL key event
  $(document).keydown(function(event) {
  	 if (event.ctrlKey && event.keyCode == 81) { //CTRL + Q event
  		event.preventDefault();
  		//saveForm();
  		uploadMethod();
  		event.stopPropagation();
  		return false;
  	} else if (event.ctrlKey && event.keyCode == 71) { //CTRL + G event
  		event.preventDefault();
  		GenerateMethod();
  		event.stopPropagation();
  		return false;
  	} else if (event.ctrlKey && event.keyCode == 79) { //CTRL + O event
  		
  		event.preventDefault();
  		BeatSequence_closeAndClear();
  		event.stopPropagation();
  		return false;
  	}
  	return true;
  });
 	
  function GenerateMethod(){
		 var jsonObj=[];
	     var jsonObjforheaders=[];
	     var jsonObjfileInfi=[];
	     
	     showDiaplyAlertMessages("Generating Report....", "info");
		$(':focus').blur();

		//jsonObj.push({':beatList': outputObj.selBeats});
		jsonObjfileInfi.push({'title':"Credit Locking,Credit Locking",
			'reportfilename':"Credit Locking",
			'viewpage':"Credit_Limit_Setting_Upload/credit_limit_setting_upload",
			'viewname':"Credit_Limit_Submit_Upload_SP",
			'querycount':1
			});

		var jsonObjWhereClause = {':beatList': (outputObj.selBeats == 'undefined' ? '' : outputObj.selBeats) };	
			  jsonObjforheaders.push({});
			  displayLoadingImage();
			$.ajax({
				method : "POST",
				url : '/rsunify/app/reportsController/generatereport.do',
				data : {
					'jsonData' : JSON.stringify(jsonObj),//json object to store  to sql data
	   				'jsonObjforheaders':JSON.stringify(jsonObjforheaders),//json object to store header lebel of report
	   				'jsonObjfileInfi':JSON.stringify(jsonObjfileInfi),// json object to store report file name,title and view resolver
	   				//'orderBy':"mkm_name, Par_Sequence,par_name,CLD_BILLREFR,bnk_name",//order condition
	   				'jsonObjWhereClause':JSON.stringify(jsonObjWhereClause),//Where condition 
	   				
				},
				success : function(data) {
					hideLoadingImage();
					//alert(data)
					if(data != undefined && $.trim(data) != ""){
						//var options = 'height=' + screen.height + ',width=' + screen.width + ',resizable=0,scrollbars=0,toolbar=0,menubar=0,location=0';
						//window.open(data, "_blank",options);
						showDiaplyAlertMessages("Generated Report Successfully", "info");
						downloadReportFile("/rsunify", data);
					}else{
						showDiaplyAlertMessages("No Records Found", "error");
					}
				 }
			}); 
  	}
</script>

</body>
</html>
<!-- outputObj.selBeats-->
